Náº¿u báº¡n muá»‘n mÃ¬nh giáº£i thÃ­ch thÃªm vá» cÃ¡ch táº¡o context, hoáº·c viáº¿t máº«u táº­p tin kubeconfig cho mÃ´i trÆ°á»ng nhiá»u cá»¥m, mÃ¬nh cÃ³ thá»ƒ lÃ m ngay -> giÃºp mÃ¬nh cÃ¡i nÃ y
Tuyá»‡t vá»i Dong! MÃ¬nh sáº½ giÃºp báº¡n hiá»ƒu rÃµ cÃ¡ch táº¡o context vÃ  viáº¿t máº«u táº­p tin kubeconfig cho mÃ´i trÆ°á»ng cÃ³ nhiá»u cá»¥m Kubernetes â€” ráº¥t há»¯u Ã­ch trong mÃ´i trÆ°á»ng production khi báº¡n cáº§n quáº£n lÃ½ nhiá»u cluster, namespace vÃ  ngÆ°á»i dÃ¹ng.

ğŸ§  1. Hiá»ƒu vá» context trong kubeconfig
Context lÃ  má»™t cáº¥u hÃ¬nh káº¿t há»£p giá»¯a:

Má»™t cluster (mÃ¡y chá»§ API)
Má»™t user (thÃ´ng tin xÃ¡c thá»±c)
Má»™t namespace (pháº¡m vi lÃ m viá»‡c)

ğŸ‘‰ Má»—i context giÃºp báº¡n chuyá»ƒn Ä‘á»•i nhanh giá»¯a cÃ¡c cá»¥m vÃ  ngÆ°á»i dÃ¹ng mÃ  khÃ´ng cáº§n viáº¿t láº¡i lá»‡nh dÃ i dÃ²ng.

ğŸ“ 2. Máº«u táº­p tin kubeconfig cho nhiá»u cá»¥m
yaml
apiVersion: v1
kind: Config

clusters:
- name: prod-cluster
  cluster:
    server: https://api.prod.example.com
    certificate-authority: /etc/kubernetes/pki/prod-ca.crt

- name: staging-cluster
  cluster:
    server: https://api.staging.example.com
    certificate-authority: /etc/kubernetes/pki/staging-ca.crt

users:
- name: admin-prod
  user:
    client-certificate: /etc/kubernetes/pki/admin-prod.crt
    client-key: /etc/kubernetes/pki/admin-prod.key

- name: admin-staging
  user:
    client-certificate: /etc/kubernetes/pki/admin-staging.crt
    client-key: /etc/kubernetes/pki/admin-staging.key

contexts:
- name: prod-context
  context:
    cluster: prod-cluster
    user: admin-prod
    namespace: default

- name: staging-context
  context:
    cluster: staging-cluster
    user: admin-staging
    namespace: dev

current-context: prod-context
ğŸ› ï¸ 3. CÃ¡ch táº¡o context báº±ng lá»‡nh kubectl
Náº¿u báº¡n Ä‘Ã£ cÃ³ cluster vÃ  user, báº¡n cÃ³ thá»ƒ táº¡o context báº±ng lá»‡nh:

bash
kubectl config set-context prod-context \
  --cluster=prod-cluster \
  --user=admin-prod \
  --namespace=default

kubectl config set-context staging-context \
  --cluster=staging-cluster \
  --user=admin-staging \
  --namespace=dev
ğŸ”„ 4. Chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c context
bash
kubectl config use-context prod-context
kubectl config use-context staging-context
ğŸ” 5. Kiá»ƒm tra context hiá»‡n táº¡i
bash
kubectl config current-context
Náº¿u báº¡n muá»‘n mÃ¬nh viáº¿t script tá»± Ä‘á»™ng táº¡o kubeconfig cho tá»«ng cá»¥m, hoáº·c chia quyá»n theo nhÃ³m Dev/Ops/CI, mÃ¬nh cÃ³ thá»ƒ lÃ m ngay. Báº¡n Ä‘ang dÃ¹ng kubeadm Ä‘á»ƒ triá»ƒn khai cá»¥m Ä‘Ãºng khÃ´ng Dong? Hay báº¡n muá»‘n tÃ­ch há»£p vá»›i GitLab CI/CD luÃ´n?
